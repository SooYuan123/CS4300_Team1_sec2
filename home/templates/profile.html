{% load static %}
{% load profile_filters %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ profile_user.username }}'s Profile - CelestiaTrack</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'styles.css' %}">
</head>

<body>
  {% include 'header.html' %}

  <div class="hero">
    <div class="container mt-5">
      <div class="row">
        <!-- Profile Card (Left Column) -->
        <div class="col-md-4 mb-4">
          <div class="card bg-dark text-light border-info">
            <div class="card-body text-center">
              <!-- Profile Picture -->
              <img src="{{ profile.get_profile_picture_url }}"
                   alt="{{ profile_user.username }}'s profile picture"
                   class="rounded mb-3"
                   style="width: 200px; height: 200px; object-fit: cover; border: 3px solid #00d4ff; box-shadow: 0 0 20px #00d4ff; border-radius: 10px;">

              <!-- Username -->
              <h3 class="text-glow">{{ profile_user.username }}</h3>

              <!-- Full Name -->
              {% if profile_user.first_name or profile_user.last_name %}
              <p class="text-muted">
                {{ profile_user.first_name }} {{ profile_user.last_name }}
              </p>
              {% endif %}

              <!-- Edit Button (only for own profile) -->
              {% if is_own_profile %}
              <a href="{% url 'profile_edit' %}" class="btn btn-glow mt-3 w-100">
                <i class="fas fa-edit"></i> Edit Profile
              </a>
              {% endif %}
            </div>
          </div>

          <!-- Account Info Card -->
          <div class="card mt-3 bg-dark text-light border-info">
            <div class="card-body">
              <h5 class="card-title text-glow">Account Info</h5>
              <p class="mb-1"><strong>Email:</strong> {{ profile_user.email }}</p>
              {% if profile.location %}
              <p class="mb-1"><strong>Location:</strong> <i class="fas fa-map-marker-alt text-info"></i> {{ profile.location }}</p>
              {% endif %}
              <p class="mb-1"><strong>Joined:</strong> {{ profile_user.date_joined|date:"F d, Y" }}</p>
              <p class="mb-0"><strong>Last Updated:</strong> {{ profile.updated_at|date:"F d, Y" }}</p>
            </div>
          </div>
        </div>

        <!-- Profile Details (Right Column) -->
        <div class="col-md-8">
          <!-- Bio Section -->
          <div class="card mb-3 bg-dark text-light border-info">
            <div class="card-header bg-transparent border-info">
              <h4 class="text-glow">About</h4>
            </div>
            <div class="card-body">
              {% if profile.bio %}
                <p>{{ profile.bio }}</p>
              {% else %}
                <p class="text-muted">
                  {% if is_own_profile %}
                    You haven't added a bio yet. Click "Edit Profile" to add one!
                  {% else %}
                    This user hasn't added a bio yet.
                  {% endif %}
                </p>
              {% endif %}
            </div>
          </div>

          <!-- Favorite Celestial Objects -->
          {% if profile.favorite_celestial_body %}
          <div class="card mb-3 bg-dark text-light border-info">
            <div class="card-header bg-transparent border-info">
              <h4 class="text-glow">Favorite Celestial Objects</h4>
            </div>
            <div class="card-body">
              {% for object in profile.favorite_celestial_body|split:',' %}
                <p class="mb-2">
                  <i class="fas fa-star text-warning"></i> {{ object }}
                </p>
              {% endfor %}
            </div>
          </div>
          {% endif %}

          <!-- Favorite Events -->
          <div class="card bg-dark text-light border-info">
            <div class="card-header bg-transparent border-info">
              <h4 class="text-glow">Favorite Events</h4>
            </div>
            <div class="card-body">
              <p class="text-muted">
                {% if is_own_profile %}
                  Your favorite events will appear here.
                {% else %}
                  {{ profile_user.username }}'s favorite events will appear here.
                {% endif %}
              </p>
              <!-- TODO: Add favorite events gallery here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>CelestiaTrack - Guided by the light of discovery.</p>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>